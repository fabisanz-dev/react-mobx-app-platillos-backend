var myModal=document.getElementsByClassName("modalID")[0],config={apiKey:"AIzaSyD_hLZRgCDgtOB8mSzd88KcUORDlFQk-GY",authDomain:"adiminappcomidas.firebaseapp.com",databaseURL:"https://adiminappcomidas.firebaseio.com",projectId:"adiminappcomidas",storageBucket:"adiminappcomidas.appspot.com",messagingSenderId:"321094089268"};firebase.initializeApp(config);var ingresar=function(){var a=document.getElementById("user_email").value,b=document.getElementById("user_psw").value;firebase.auth().signInWithEmailAndPassword(a,b).then(function(){console.log("logueado correctamente"),window.location="./back_restaurant_app.html"}).catch(function(c){var d=c.code,f=c.message;console.log("ha ocurrido un error:"+f+""+d)})};firebase.auth().onAuthStateChanged(function(a){a?console.log("sesion activa"):(console.log("No autorizado"),"/index.html"!=window.location.pathname&&(window.location.href="/index.html"))});var signOut=function(){firebase.auth().signOut().then(function(){console.log("sesion cerrada exitosamente")},function(a){console.log("ha ocurrido un error:"+a)})},database=firebase.database();function cargarFormulario(a){a.preventDefault();var b=document.getElementById("nombrePlatillo").value,c=document.getElementById("descripcionPlatillo").value,d=document.getElementById("cantidadPlatillo").value,f=document.getElementById("precioPlatillo").value,g=document.getElementById("imagenPlatillo").value,h=document.getElementById("nombreImagenPlatillo").value;try{agregarAlimento(b,c,d,f,h,g)}catch(i){console.log("ha ocurrido un error"+i)}}var agregarAlimento=function(a,b,c,d,f,g){database.ref("alimentos/").push({nombre:a,descripcion:b,cantidad:c,precio:d,nombreImg:f,linkImg:g}).then(function(){alert("registro agregado correctamente"),window.location.href="./listadoPlatillos.html"}).catch(function(h){alert("Ha ocurrido un error:"+h)})};function imprimirListadoPlatillos(){var a=database.ref("alimentos/");a.on("value",function(b){null==b.val()?document.getElementById("listadoBebidas").appendChild(document.createTextNode("No se encuentran registros...")):(document.getElementById("LoadPreview_listPlt").style.display="none",b.forEach(function(c){var d=c.key,f=c.val(),g=document.getElementById("listadoPlatillos"),h=document.createElement("ul"),i=document.createElement("li"),j=document.createElement("div"),k=document.createElement("img"),l=document.createElement("button"),m=document.createElement("button");l.setAttribute("id",d),l.appendChild(document.createTextNode("Eliminar")),l.setAttribute("onClick","eliminarItemPlatillo(this.id)"),m.setAttribute("id",d),m.appendChild(document.createTextNode("Editar")),m.setAttribute("onClick","editarItemPlatillo(this.id)"),k.src=f.linkImg,k.height="40",k.alt="img_platillo",j.appendChild(k),i.appendChild(j),i.appendChild(document.createTextNode("Nombre:"+f.nombre)),i.appendChild(document.createElement("br")),i.appendChild(document.createTextNode("Descripcion:"+f.descripcion)),i.appendChild(document.createElement("br")),i.appendChild(document.createTextNode("Precio: $"+f.precio)),i.appendChild(document.createElement("br")),i.appendChild(l),i.appendChild(m),h.appendChild(i),g.appendChild(h),h.setAttribute("class","list-group"),i.setAttribute("class","list-group-item"),j.style.float="right"}))})}function editarItemPlatillo(a){var b=database.ref("alimentos/"+a);b.once("value").then(function(c){var d=c.val(),f=c.key,g=new Modal(myModal,{content:`
                <div class="modal-header">
                    <h4 class="modal-title">Editar Platillo</h4>
                </div>
                <class="modal-body"> 
                    <div class="col-md-12">
                            <form  action="#" onSubmit="return actualizarFormularioPlatillo(event)" name="formularioPlatillos_act">
                                <input type="text" id="idPlatillo_act" value="${f}" hidden> 
                                cambiar imagen: <input class="btn btn-default" type="file" id="imgPlatillo_new" onchange="visualizarImagenPlatillo_act()"><br><br>
                                <img src="${d.linkImg}" alt="img_platillo_Act" height="100" id="imgPlatillo_act" class="center-block">
                                <p class="text-center" id="imgPlatillosBarAct">
                                   ...
                                </p>
                                <br><br> 
                                Nombre Imagen: <input type="text" class="form-control" type="text"  id="nombreImagenPlatillo_act" required value="${d.nombreImg}" readonly/>
                                Enlace: <input class="form-control" type="text" name="imagenPlatillo" id="imagenPlatillo_act" value="${d.linkImg}" readonly/>
                                <hr>
                                nombre: <input  class="form-control" type="text"  id="nombrePlatillo_act" required value="${d.nombre}">
                                <br>
                                Descripcion:
                                    <textarea class="form-control"  id="descripcionPlatillo_act" cols="20" rows="2" required>${d.descripcion}</textarea>
                                <br>
                                Cantidad: <input class="form-control" type="number" min="0" max="10" id="cantidadPlatillo_act" value="${d.cantidad}">
                                <br>
                                    Precio: <input class="form-control" type="text"  id="precioPlatillo_act" value="${d.precio}">
                                <br>
                                <input class="btn btn-success center-block" type="submit" value="Actualizar">
                            </form>
                    </div>
                </div>
                <div class="modal-footer">     
                </div>
                `,backdrop:"static",keyboard:!1});g.show()})}function actualizarFormularioPlatillo(a){a.preventDefault();var b=new Modal(myModal);b.hide();var c=document.getElementById("idPlatillo_act").value,d=document.getElementById("nombrePlatillo_act").value;var f=document.getElementById("descripcionPlatillo_act").value,g=document.getElementById("precioPlatillo_act").value,h=document.getElementById("cantidadPlatillo_act").value,i=document.getElementById("nombreImagenPlatillo_act").value,j=document.getElementById("imagenPlatillo_act").value;actualizarAlimento(c,d,f,g,h,i,j)}var actualizarAlimento=function(a,b,c,d,f,g,h){database.ref("alimentos/"+a).update({nombre:b,descripcion:c,precio:d,cantidad:f,nombreImg:g,linkImg:h}).then(function(){alert("registro actualizado!"),reloadPage()})};function eliminarItemPlatillo(a){var b=confirm("Esta seguro de que quiere eliminar este item?");!0==b?database.ref("alimentos/"+a).remove().then(function(){alert("item eliminado correctamente"),reloadPage()}).cath(function(c){alert("se ha producido un error:"+c)}):alert("operacion cancelada")}function reloadPage(){location.reload(!0)}const storage=firebase.storage(),storageRef=storage.ref();function visualizarImagenPlatillo(){var a=document.querySelector("img"),b=document.querySelector("input[type=file]").files[0],c=new FileReader;if(c.onloadend=function(){a.src=c.result},b){c.readAsDataURL(b);var d=storageRef.child("platillos/"+b.name).put(b);d.on("state_changed",function(f){var g=100*(f.bytesTransferred/f.totalBytes);switch(console.log("Upload is "+g+"% done"),document.getElementById("imgPlatillosBar").style.width=parseInt(g)+"%",f.state){case firebase.storage.TaskState.PAUSED:console.log("Upload is paused");break;case firebase.storage.TaskState.RUNNING:console.log("Upload is running");}},function(f){switch(f.code){case"storage/unauthorized":break;case"storage/canceled":break;case"storage/unknown":}},function(){console.log(d.snapshot.downloadURL),document.getElementById("imagenPlatillo").value=d.snapshot.downloadURL,document.getElementById("nombreImagenPlatillo").value=b.name})}else a.src=""}function visualizarImagenPlatillo_act(){var a=document.getElementById("imgPlatillo_act"),b=document.getElementById("imgPlatillo_new").files[0],c=new FileReader,d=document.getElementById("nombreImagenPlatillo_act").value;if(c.onloadend=function(){a.src=c.result},b){c.readAsDataURL(b);var f=storageRef.child("platillos/"+d);f.delete().then(function(){console.log("File deleted successfully");var g=firebase.storage().ref().child("platillos/"+b.name).put(b);g.on("state_changed",function(h){var i=100*(h.bytesTransferred/h.totalBytes);switch(console.log("Upload is "+i+"% done"),document.getElementById("imgPlatillosBarAct").innerHTML=parseInt(i)+"%",h.state){case firebase.storage.TaskState.PAUSED:console.log("Upload is paused");break;case firebase.storage.TaskState.RUNNING:console.log("Upload is running");}},function(h){switch(h.code){case"storage/unauthorized":break;case"storage/canceled":break;case"storage/unknown":}},function(){console.log(g.snapshot.downloadURL),document.getElementById("imagenPlatillo_act").value=g.snapshot.downloadURL,document.getElementById("nombreImagenPlatillo_act").value=b.name,console.log(document.getElementById("nombreImagenPlatillo_act").value)})}).catch(function(g){console.log("Uh-oh, an error occurred!"+g)})}else a.src=""}var imprimirListadoBebidas=function(){var a=database.ref("bebidas/");a.on("value",function(b){null==b.val()?(console.log(null==b.val()),document.getElementById("listadoBebidas").appendChild(document.createTextNode("No se encuentran registros..."))):(document.getElementById("LoadPreview_listBeb").style.display="none",b.forEach(function(c){var d=c.key,f=c.val(),g=document.getElementById("listadoBebidas"),h=document.createElement("ul"),i=document.createElement("li"),j=document.createElement("div"),k=document.createElement("img"),l=document.createElement("button");l.setAttribute("id",d),l.appendChild(document.createTextNode("Eliminar")),l.setAttribute("onClick","eliminarItemBebidas(this.id)"),k.src=f.imagen,k.height="40",k.alt="img_bebida",j.appendChild(k),i.appendChild(j),i.appendChild(document.createTextNode("Nombre:"+f.nombre)),i.appendChild(document.createElement("br")),i.appendChild(document.createTextNode("Descripcion:"+f.descripcion)),i.appendChild(document.createElement("br")),i.appendChild(document.createTextNode("Precio: $"+f.precio)),i.appendChild(document.createElement("br")),i.appendChild(l),h.appendChild(i),g.appendChild(h),h.setAttribute("class","list-group"),i.setAttribute("class","list-group-item"),j.style.float="right"}))})};function visualizarImagenBebidas(){var a=document.getElementById("imgBebidaId"),b=document.getElementById("imgBebida").files[0],c=new FileReader;if(c.onloadend=function(){a.src=c.result},b){c.readAsDataURL(b);var d=firebase.storage().ref().child("bebidas/"+b.name).put(b);d.on("state_changed",function(f){var g=100*(f.bytesTransferred/f.totalBytes);switch(console.log("Upload is "+g+"% done"),document.getElementById("imgBebidasBar").style.width=parseInt(g)+"%",f.state){case firebase.storage.TaskState.PAUSED:console.log("Upload is paused");break;case firebase.storage.TaskState.RUNNING:console.log("Upload is running");}},function(f){switch(f.code){case"storage/unauthorized":break;case"storage/canceled":break;case"storage/unknown":}},function(){console.log(d.snapshot.downloadURL),document.getElementById("imagenBebidas").value=d.snapshot.downloadURL})}else a.src=""}var cargarFormularioBebidas=function(a){a.preventDefault();var b=document.getElementById("imagenBebidas").value,c=document.getElementById("nombreBebidas").value,d=document.getElementById("descripcionBebidas").value,f=document.getElementById("cantidadBebidas").value,g=document.getElementById("precioBebidas").value;try{cargarBebida(c,d,f,g,b)}catch(h){alert("ha ocurrido un error")}},cargarBebida=function(a,b,c,d,f){database.ref("bebidas/").push({nombre:a,descripcion:b,cantidad:c,precio:d,imagen:f}).then(function(){alert("registro agregado correctamente"),window.location.href="./listadoBebidas.html"}).catch(function(g){alert("Ha ocurrido un error:"+g)})};function eliminarItemBebidas(a){var b=confirm("Esta seguro de que quiere eliminar este item?");!0==b?database.ref("bebidas/"+a).remove().then(function(){alert("item eliminado correctamente"),reloadPage()}).cath(function(c){alert("se ha producido un error:"+c)}):alert("operacion cancelada")}


                console.log(window.location.pathname);